import{u as l,h as r,e as n,n as m}from"./index-4f8ea07d.js";import{ae as u,af as p,o as d,b as g,v as f,F as k}from"./vendor-0c4ad4cf.js";import"./bootstrap-2bb6cffa.js";const _={__name:"credentials",setup(h){const a=l(),s=u(),i=p(),c=async()=>{const t=i.query.token;if(t)try{localStorage.setItem("token",t);const e=await r.get(n.api+"me");a.setCurrentUser(e.data.message.data),e.data.message.data.permissions&&localStorage.setItem("permissions",JSON.stringify(e.data.message.data.permissions)),e.data.message.token&&localStorage.setItem("token",e.data.message.token);try{const o=await r.get(n.api+"enums");a.setEnums(o.data.data)}catch(o){console.warn("Não foi possível carregar enums:",o)}s.push("/")}catch(e){console.error("Erro ao verificar credenciais: ",e),m("Erro ao logar com o Google!"),localStorage.removeItem("token"),localStorage.removeItem("permissions"),a.setCurrentUser(null),await s.push("/login")}else await s.push("/login")};return d(()=>{c()}),(t,e)=>(g(),f("div",null,e[0]||(e[0]=[k("p",null,"Verificando suas credenciais...",-1)])))}};export{_ as default};
