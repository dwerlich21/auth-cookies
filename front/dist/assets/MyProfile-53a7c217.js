import{af as I,a as t,o as _,b as w,e as y,f as h,F as u,H as c,u as B}from"./vendor-0c4ad4cf.js";import{_ as S,r as P,B as F,a as M,h as D,s as U}from"./AddressSection-9d4b0347.js";import{U as $,e as x,F as A}from"./default-19b0175f.js";import{u as C,e as E}from"./index-4f8ea07d.js";import{_ as k}from"./_plugin-vue_export-helper-9e0cfb91.js";import"./page-header-5b9f94d6.js";import"./icon-29dcc68f.js";import"./utils-f4fee5ac.js";import"./cruds-22e5f14f.js";import"./bootstrap-2bb6cffa.js";const H={id:"form"},N={__name:"MyProfile",setup(R){const o=new $;I();const i=C(),a=t(o.getDefaultFormData()),f=t(!1),d=t(!1),n=t({}),m=[{value:"master",label:"Master"},{value:"admin",label:"Administrador"},{value:"secretary",label:"Secretaria"}];async function l(){try{const e=i.getUser;if(!e||!e.id)setTimeout(()=>{l()},300);else{const r=x(e.id),s=await o.getById(r);a.value={...a.value,...s,id:s.basicInfo.id},s.basicInfo.avatar&&(a.value.basicInfo.avatar=`${E.url}${s.basicInfo.avatar}`)}}catch(e){console.error("Erro ao carregar usuário:",e),A(e)}}async function v(e){try{a.value.basicInfo=await D(e,600,600,a.value.basicInfo,"img")}catch(r){console.error("Erro ao carregar a imagem:",r)}}function p(e){a.value.basicInfo=U(e,a.value.basicInfo,"img")}async function b(){try{await o.save(a.value),i.refresh()}catch(e){console.error("error",e),e.data.errors&&(n.value=e.data.errors)}}async function g(){try{const e=await o.getAddressByZipCode(a.value.address.zipCode);a.value.address.uf=e.uf,a.value.address.city=e.city,a.value.address.neighborhood=e.neighborhood,a.value.address.address=e.address,a.value.address.complement=e.complement}catch(e){console.error("Erro ao buscar endereço:",e)}}return _(async()=>{await l()}),(e,r)=>(w(),y(S,{title:"Meu Perfil","title-header":"Meu Perfil",onSubmitForm:b},{form:h(()=>[u("div",null,[u("form",H,[c(F,{"form-data":a.value.basicInfo,"onUpdate:formData":r[0]||(r[0]=s=>a.value.basicInfo=s),"access-level-options":m,data:a.value.basicInfo,errors:n.value,disabled:!0,"show-password-field":f.value,"show-password":d.value,onTogglePassword:r[1]||(r[1]=s=>d.value=!d.value),onHandleImage:v,onSetImage:p,onResetImage:r[2]||(r[2]=s=>B(P)("user-img-file-input",a.value.basicInfo,"img"))},null,8,["form-data","data","errors","show-password-field","show-password"]),c(M,{"form-data":a.value.address,"onUpdate:formData":r[3]||(r[3]=s=>a.value.address=s),data:a.value.address,errors:n.value,onSetAddress:g},null,8,["form-data","data","errors"])])])]),_:1}))}},O=k(N,[["__scopeId","data-v-d726483f"]]);export{O as default};
