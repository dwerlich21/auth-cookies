import{af as _,a as t,o as w,b as y,e as h,f as U,F as l,H as u,u as F}from"./vendor-0c4ad4cf.js";import{_ as B,r as S,B as $,a as D,h as E,s as x}from"./AddressSection-9d4b0347.js";import{U as A,F as C}from"./default-19b0175f.js";import{e as k,r as N}from"./index-4f8ea07d.js";import{_ as P}from"./_plugin-vue_export-helper-9e0cfb91.js";import"./page-header-5b9f94d6.js";import"./icon-29dcc68f.js";import"./utils-f4fee5ac.js";import"./cruds-22e5f14f.js";import"./bootstrap-2bb6cffa.js";const H={id:"form"},M="Users",R={__name:"Form",setup(V){const o=new A,c=_(),a=t(o.getDefaultFormData()),m=t(!1),i=t(!1),d=t({}),f=[{value:"master",label:"Master"},{value:"admin",label:"Administrador"},{value:"secretary",label:"Secretaria"}];async function v(e){try{const r=await o.getById(e);a.value={...a.value,...r,id:r.basicInfo.id},r.basicInfo.avatar&&(a.value.basicInfo.avatar=`${k.url}${r.basicInfo.avatar}`)}catch(r){console.error("Erro ao carregar usuário:",r),C(r)}}async function p(e){try{a.value.basicInfo=await E(e,600,600,a.value.basicInfo,"img")}catch(r){console.error("Erro ao carregar a imagem:",r)}}function b(e){a.value.basicInfo=x(e,a.value.basicInfo,"img")}async function I(){try{await o.save(a.value),N.back()}catch(e){console.error("error",e),e.data.errors&&(d.value=e.data.errors)}}async function g(){try{const e=await o.getAddressByZipCode(a.value.address.zipCode);a.value.address.uf=e.uf,a.value.address.city=e.city,a.value.address.neighborhood=e.neighborhood,a.value.address.address=e.address,a.value.address.complement=e.complement}catch(e){console.error("Erro ao buscar endereço:",e)}}return w(async()=>{try{const e=c.params.id;e&&await v(e)}catch(e){console.error("Erro ao carregar dados iniciais:",e)}}),(e,r)=>{var n;return y(),h(B,{title:a.value.id?`Editar Usuário: ${((n=a.value.basicInfo)==null?void 0:n.name)||"Usuário"}`:"Novo Usuário","title-header":a.value.id?"Edição de Usuário":"Cadastro de Usuário",session:M,onSubmitForm:I},{form:U(()=>[l("div",null,[l("form",H,[u($,{"form-data":a.value.basicInfo,"onUpdate:formData":r[0]||(r[0]=s=>a.value.basicInfo=s),"access-level-options":f,data:a.value.basicInfo,errors:d.value,"show-password-field":m.value,"show-password":i.value,onTogglePassword:r[1]||(r[1]=s=>i.value=!i.value),onHandleImage:p,onSetImage:b,onResetImage:r[2]||(r[2]=s=>F(S)("user-img-file-input",a.value.basicInfo,"img"))},null,8,["form-data","data","errors","show-password-field","show-password"]),u(D,{"form-data":a.value.address,"onUpdate:formData":r[3]||(r[3]=s=>a.value.address=s),data:a.value.address,errors:d.value,onSetAddress:g},null,8,["form-data","data","errors"])])])]),_:1},8,["title","title-header"])}}},Q=P(R,[["__scopeId","data-v-4446e151"]]);export{Q as default};
